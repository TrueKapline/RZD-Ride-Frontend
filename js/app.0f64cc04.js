(function(){"use strict";var t={6337:function(t,i,a){var e=a(9242),s=a(3396);function r(t,i,a,e,r,n){const o=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(o)}var n={},o=a(89);const l=(0,o.Z)(n,[["render",r]]);var h=l,c=a(2483),d=a(7139);const S=t=>((0,s.dD)("data-v-18aa5e52"),t=t(),(0,s.Cn)(),t),u={class:"status window"},p={class:"lower-part"},f={class:"time-table window"},w={key:0},v=S((()=>(0,s._)("div",{class:"map window"},null,-1))),m=S((()=>(0,s._)("div",{class:"interesting window"},null,-1)));function g(t,i,a,e,r,n){const o=(0,s.up)("Stations"),l=(0,s.up)("Weather");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",u,[(0,s.Wm)(o,{status:this.status},null,8,["status"]),(0,s.Wm)(l,{timeWeather:this.timeWeather},null,8,["timeWeather"])]),(0,s._)("div",p,[(0,s._)("div",f,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.arrStop,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.duration},[(0,s.Uk)((0,d.zw)(t.arrivalShow)+" ",1),t.arrivalShow&&t.departureShow?((0,s.wg)(),(0,s.iD)("span",w,"-")):(0,s.kq)("",!0),(0,s.Uk)(" "+(0,d.zw)(t.departureShow)+" "+(0,d.zw)(t.title),1)])))),128))]),v,m])],64)}var _=a(70),y=a.p+"img/sun-icon.46b9915d.svg";const E=t=>((0,s.dD)("data-v-3773da7b"),t=t(),(0,s.Cn)(),t),b={class:"time-and-weather"},D={class:"time"},H={class:"weather"},k=E((()=>(0,s._)("img",{src:y,alt:"",class:"weather-icon"},null,-1))),C={class:"weather-text"};function U(t,i,a,e,r,n){return(0,s.wg)(),(0,s.iD)("div",b,[(0,s._)("h1",D,(0,d.zw)(a.timeWeather[0]),1),(0,s._)("div",H,[k,(0,s._)("span",C,"Ясно, "+(0,d.zw)(r.weather),1)])])}var W={name:"Weather",props:{timeWeather:{type:Array}},data(){return{weather:"15°С"}},watch:{timeWeather:function(){console.log(this.timeWeather),console.log("robit")}}};const A=(0,o.Z)(W,[["render",U],["__scopeId","data-v-3773da7b"]]);var R=A;const T={class:"station-info"},z={class:"status-title"},L={class:"status-info"};function j(t,i,a,e,r,n){return(0,s.wg)(),(0,s.iD)("div",T,[(0,s._)("h1",z,(0,d.zw)(a.status[0]),1),(0,s._)("span",L,(0,d.zw)(a.status[1]),1)])}var Z={name:"Status",props:{status:{type:Array}}};const O=(0,o.Z)(Z,[["render",j],["__scopeId","data-v-fc0f2636"]]);var x=O,N={components:{Stations:x,Weather:R},props:{uid:{type:String},date:{type:String}},data(){return{baseURL:"https://mypew.ru:3001/stops",arrStop:[],interval:null,timeWeather:["",""],status:["",""],baseURLWeather:"https://mypew.ru:3001/weather",stationNow:""}},methods:{async loadTrip(){try{let t=new Date,i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()+parseInt(this.date[21]),t.getUTCMinutes(),t.getUTCSeconds()).toLocaleString(),a=i.slice(6,10)+"-"+i.slice(3,5)+"-"+i.slice(0,2)+" "+i.slice(12,20);this.timeWeather[0]=i.slice(12,20);const e=await _.ZP.get(this.baseURL+"?uid="+this.uid+"&date="+this.date.slice(0,10));this.arrStop=e.data.stops,this.arrStop[0].departure>a&&(this.status[0]="Поезд ещё не выехал"),this.arrStop[this.arrStop.length-1].arrival<a&&(this.status[0]="Поезд уже закончил свой маршрут"),console.log(this.arrStop),this.arrStop.forEach(((t,i)=>{if(t.arrival&&(t.arrivalShow=t.arrival.slice(11,16)),t.departure&&(t.departureShow=t.departure.slice(11,16)),t.departure>a&&t.arrival<a){if(this.status[0]="Стоянка на станции "+t.title,this.stationNow!=t.title)try{this.loadWeather(t.title),this.stationNow=t.title}catch(e){alert("Error: "+e)}i<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[i+1].title)}else if(i<this.arrStop.length-1&&t.departure<a&&this.arrStop[this.arrStop.length-1].arrival>a){if(this.status[0]=t.title+" - "+this.arrStop[i+1].title,""==this.stationNow&&i>0)try{this.loadWeather(t.title),this.stationNow=t.title}catch(e){alert("Error: "+e)}i<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[i+1].title)}})),this.interval=setInterval((()=>{let t=new Date,i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()+parseInt(this.date[21]),t.getUTCMinutes(),t.getUTCSeconds()).toLocaleString(),a=i.slice(6,10)+"-"+i.slice(3,5)+"-"+i.slice(0,2)+" "+i.slice(12,20);this.timeWeather[0]=i.slice(12,20),this.arrStop.forEach(((t,i)=>{if(t.departure>a&&t.arrival<=a){if(this.status[0]="Стоянка на станции "+t.title,this.stationNow!=t.title)try{this.loadWeather(t.title),this.stationNow=t.title}catch(e){alert("Error: "+e)}i<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[i+1].title)}else if(i<this.arrStop.length-1&&t.departure<=a&&this.arrStop[this.arrStop.length-1].arrival>a){if(this.status[0]=t.title+" - "+this.arrStop[i+1].title,""==this.stationNow)try{this.loadWeather(t.title),this.stationNow=t.title}catch(e){alert("Error: "+e)}i<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[i+1].title)}}))}),1e3)}catch(t){alert("Error: "+t)}},async loadWeather(t){const i=await _.ZP.get(this.baseURLWeather+"?type_info=fact&station_name="+t);this.timeWeather[1]=i.data,console.log(this.timeWeather[1])}},created(){this.loadTrip()}};const P=(0,o.Z)(N,[["render",g],["__scopeId","data-v-18aa5e52"]]);var I=P,Y=(a(7658),a.p+"img/arrows.985ee4d1.svg");const K=t=>((0,s.dD)("data-v-124b3a0f"),t=t(),(0,s.Cn)(),t),M={class:"window search"},F=K((()=>(0,s._)("h1",{class:"header"},"Расписание электричек",-1))),V={class:"form"},q={class:"from"},$=K((()=>(0,s._)("label",{for:"from",class:"from__label"},"Откуда",-1))),B={class:"from__hint"},G=["onClick"],J={class:"to"},Q=K((()=>(0,s._)("label",{for:"to",class:"to__label"},"Куда",-1))),X={class:"to__hint"},tt=["onClick"],it=K((()=>(0,s._)("div",{class:"headings"},[(0,s._)("p",null,"Отпр."),(0,s._)("p",null,"Приб."),(0,s._)("p",null,"В пути"),(0,s._)("p",null,"Маршрут")],-1))),at=K((()=>(0,s._)("hr",null,null,-1))),et={class:"wrapper"},st=["value","onClick"],rt={class:"parameters"},nt={class:"parameter"},ot={class:"parameter"},lt={class:"parameter"},ht={class:"parameter"},ct=K((()=>(0,s._)("hr",null,null,-1)));function dt(t,i,a,r,n,o){return(0,s.wg)(),(0,s.iD)("main",{style:(0,d.j5)(n.isResultHidden?"justify-content: center":"")},[(0,s._)("div",M,[F,(0,s._)("div",V,[(0,s._)("div",q,[(0,s.wy)((0,s._)("input",{type:"text",id:"from",class:"from__input",placeholder:" ",autocomplete:"off",onClick:i[0]||(i[0]=t=>o.clickStartStation()),"onUpdate:modelValue":i[1]||(i[1]=t=>n.startStation=t),onKeyup:i[2]||(i[2]=(0,e.D2)((t=>o.enterClicked()),["enter"]))},null,544),[[e.nr,n.startStation]]),$,(0,s._)("div",B,(0,d.zw)(n.fromHint),1),(0,s._)("div",{class:"search-results",style:(0,d.j5)(n.isAvailStart?"display: block":"display: none")},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.arrStartStation,(t=>((0,s.wg)(),(0,s.iD)("button",{onClick:i=>o.addStartStation(t.station_name),class:"element-button",key:t.station_yandex_code},(0,d.zw)(t.station_name),9,G)))),128))],4)]),(0,s._)("img",{src:Y,alt:"",draggable:"false",onClick:i[3]||(i[3]=t=>o.changeStation()),style:{cursor:"pointer"}}),(0,s._)("div",J,[(0,s.wy)((0,s._)("input",{type:"text",id:"to",class:"to__input",placeholder:" ",autocomplete:"off",onClick:i[4]||(i[4]=t=>o.clickEndStation()),"onUpdate:modelValue":i[5]||(i[5]=t=>n.endStation=t),onKeyup:i[6]||(i[6]=(0,e.D2)((t=>o.enterClicked()),["enter"]))},null,544),[[e.nr,n.endStation]]),Q,(0,s._)("div",X,(0,d.zw)(n.toHint),1),(0,s._)("div",{class:"search-results",style:(0,d.j5)(n.isAvailEnd?"display: block":"display: none")},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.arrEndStation,(t=>((0,s.wg)(),(0,s.iD)("button",{onClick:i=>o.addEndStation(t.station_name),class:"element-button",key:t.station_yandex_code},(0,d.zw)(t.station_name),9,tt)))),128))],4)]),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":i[7]||(i[7]=t=>n.selectDate=t),type:"date",id:"date",class:"date"},null,512),[[e.nr,n.selectDate]]),(0,s._)("button",{class:"search-button",onClick:i[8]||(i[8]=t=>o.getStation())},"Найти маршруты")])]),(0,s._)("div",{class:"window results",style:(0,d.j5)(n.isResultHidden?"display: none":"")},[it,at,(0,s._)("div",et,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.arrRoute,(i=>((0,s.wg)(),(0,s.iD)("div",{class:"results-list",key:i.uid,value:i.uid,onClick:a=>{t.$router.push({name:"TripPage",params:{uid:i.uid,date:i.dep}})}},[(0,s._)("div",rt,[(0,s._)("span",nt,(0,d.zw)(i.depShow),1),(0,s._)("span",ot,(0,d.zw)(i.arrShow),1),(0,s._)("span",lt,(0,d.zw)(i.travelTimeShow),1),(0,s._)("span",ht,(0,d.zw)(i.title),1)]),ct],8,st)))),128))])],4)],4)}var St={data(){return{startStation:"",endStation:"",baseURL:"https://mypew.ru:3001/routes",findURL:"https://mypew.ru:3001/possible",arrRoute:[],arrStartStation:[],isAvailStart:!1,arrEndStation:[],isAvailEnd:!1,isResultHidden:!0,selectStartStation:!1,selectEndStation:!1,selectDate:"",fromHint:"",toHint:""}},methods:{async changeStartStation(){this.startStation=this.startStation.trimStart();let t=this.startStation;if(""==this.startStation||this.selectStartStation)this.fromHint="",this.selectStartStation=!1,this.isAvailStart=!1,this.arrStartStation=[];else try{0!==this.arrStartStation.length?this.fromHint=this.startStation.trim()+this.arrStartStation[0].station_name.slice(this.startStation.trim().length):this.fromHint="";const i=await _.ZP.get(this.findURL+"?station_name="+this.startStation.trim());t===this.startStation&&(this.arrStartStation=i.data,0!==this.arrStartStation.length?(this.isAvailStart=!0,this.fromHint=this.startStation.trim()+this.arrStartStation[0].station_name.slice(this.startStation.trim().length)):(this.fromHint="",this.arrStartStation=[],this.isAvailStart=!1))}catch(i){alert("Error: "+i)}},async changeEndStation(){this.endStation=this.endStation.trimStart();let t=this.endStation;if(""==this.endStation||this.selectEndStation)this.toHint="",this.selectEndStation=!1,this.isAvailEnd=!1,this.arrEndStation=[];else try{0!==this.arrEndStation.length?this.toHint=this.endStation.trim()+this.arrEndStation[0].station_name.slice(this.endStation.trim().length):this.toHint="";const i=await _.ZP.get(this.findURL+"?station_name="+this.endStation);t===this.endStation&&(this.arrEndStation=i.data,0!==this.arrEndStation.length?(this.isAvailEnd=!0,this.toHint=this.endStation.trim()+this.arrEndStation[0].station_name.slice(this.endStation.trim().length)):(this.toHint="",this.arrEndStation=[],this.isAvailEnd=!1))}catch(i){alert("Error: "+i)}},clickStartStation(){this.selectStartStation=!1,this.arrEndStation=[],this.isAvailEnd=!1,this.changeStartStation()},clickEndStation(){this.selectEndStation=!1,this.arrStartStation=[],this.isAvailStart=!1,this.changeEndStation()},addStartStation(t){this.selectStartStation=!0,this.startStation=t,this.arrStartStation=[],this.isAvailStart=!1,this.fromHint=""},addEndStation(t){this.selectEndStation=!0,this.endStation=t,this.arrEndStation=[],this.isAvailEnd=!1,this.toHint=""},async getStation(){if(this.arrStartStation=[],this.isAvailEnd=!1,this.arrEndStation=[],this.isAvailStart=!1,""!=this.startStation&&""!=this.endStation&&""!=this.selectDate)try{const t=await _.ZP.get(this.baseURL+"?from="+this.startStation+"&to="+this.endStation+"&transport_types=suburban&date="+this.selectDate);this.isResultHidden=!1,this.arrRoute=t.data,console.log(this.arrRoute),this.arrRoute.map((t=>{t.hour=t.dep[21],t.depShow=t.dep.slice(11,16),t.arrShow=t.arr.slice(11,16);let i=(new Date(t.arr)-new Date(t.dep))/6e4,a=0;i>=60?(a=Math.trunc(i/60),t.travelTimeShow=a+" ч "):t.travelTimeShow="",t.travelTimeShow+=i-60*a+" м"}))}catch(t){alert("Error: "+t)}},changeStation(){this.selectStartStation=!0,this.arrEndStation=[],this.isAvailEnd=!1,this.selectEndStation=!0,this.arrStartStation=[],this.isAvailStart=!1;let t=this.startStation;this.startStation=this.endStation,this.endStation=t},enterClicked(){""!=this.fromHint&&(this.startStation=this.fromHint,this.fromHint=""),""!=this.toHint&&(this.endStation=this.toHint,this.toHint="")}},watch:{startStation:function(){this.changeStartStation()},endStation:function(){this.changeEndStation()}},created(){let t=(new Date).toLocaleDateString();this.selectDate=t.slice(6,10)+"-"+t.slice(3,5)+"-"+t.slice(0,2),document.addEventListener("click",(()=>{this.selectStartStation=!1,this.arrEndStation=[],this.isAvailEnd=!1,this.selectEndStation=!1,this.arrStartStation=[],this.isAvailStart=!1,this.fromHint="",this.toHint=""}))}};const ut=(0,o.Z)(St,[["render",dt],["__scopeId","data-v-124b3a0f"]]);var pt=ut;const ft=[{path:"/trip/:uid/:date",name:"TripPage",component:I,props:!0},{path:"/",component:pt}],wt=(0,c.p7)({routes:ft,history:(0,c.r5)("/RZD-Ride-Frontend/")});var vt=wt;(0,e.ri)(h).use(vt).mount("#app")}},i={};function a(e){var s=i[e];if(void 0!==s)return s.exports;var r=i[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,function(){var t=[];a.O=function(i,e,s,r){if(!e){var n=1/0;for(c=0;c<t.length;c++){e=t[c][0],s=t[c][1],r=t[c][2];for(var o=!0,l=0;l<e.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((function(t){return a.O[t](e[l])}))?e.splice(l--,1):(o=!1,r<n&&(n=r));if(o){t.splice(c--,1);var h=s();void 0!==h&&(i=h)}}return i}r=r||0;for(var c=t.length;c>0&&t[c-1][2]>r;c--)t[c]=t[c-1];t[c]=[e,s,r]}}(),function(){a.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(i,{a:i}),i}}(),function(){a.d=function(t,i){for(var e in i)a.o(i,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)}}(),function(){a.p="/RZD-Ride-Frontend/"}(),function(){var t={143:0};a.O.j=function(i){return 0===t[i]};var i=function(i,e){var s,r,n=e[0],o=e[1],l=e[2],h=0;if(n.some((function(i){return 0!==t[i]}))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(l)var c=l(a)}for(i&&i(e);h<n.length;h++)r=n[h],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(c)},e=self["webpackChunkrzd_ride_frontend"]=self["webpackChunkrzd_ride_frontend"]||[];e.forEach(i.bind(null,0)),e.push=i.bind(null,e.push.bind(e))}();var e=a.O(void 0,[998],(function(){return a(6337)}));e=a.O(e)})();
//# sourceMappingURL=app.0f64cc04.js.map