(function(){var t={6241:function(t,i,a){"use strict";var s=a(9242),n=a(3396);function r(t,i,a,e,s,r){const o=(0,n.up)("router-view");return(0,n.wg)(),(0,n.j4)(o)}var o={},l=a(89);const c=(0,l.Z)(o,[["render",r]]);var h=c,d=a(2483),u=a(7139);const p=t=>((0,n.dD)("data-v-6533fa45"),t=t(),(0,n.Cn)(),t),_={class:"status window"},S={class:"lower-part"},m={class:"time-table window"},v={key:0},w=p((()=>(0,n._)("div",{class:"map window"},null,-1))),f=p((()=>(0,n._)("div",{class:"interesting window"},null,-1)));function g(t,i,a,e,s,r){const o=(0,n.up)("Stations"),l=(0,n.up)("Weather");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",_,[(0,n.Wm)(o,{status:this.status},null,8,["status"]),(0,n.Wm)(l,{time:this.time,weather:s.weather},null,8,["time","weather"])]),(0,n._)("div",S,[(0,n._)("div",m,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.arrStop,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t.duration},[(0,n.Uk)((0,u.zw)(t.arrivalShow)+" ",1),t.arrivalShow&&t.departureShow?((0,n.wg)(),(0,n.iD)("span",v,"-")):(0,n.kq)("",!0),(0,n.Uk)(" "+(0,u.zw)(t.departureShow)+" "+(0,u.zw)(t.title),1)])))),128))]),w,f])],64)}var y=a(70);const b={class:"time-and-weather"},E={class:"time"},H={class:"weather"},D=["src"],k={class:"weather-text"};function x(t,i,e,s,r,o){return(0,n.wg)(),(0,n.iD)("div",b,[(0,n._)("h1",E,(0,u.zw)(e.time),1),(0,n._)("div",H,[(0,n._)("img",{src:a(8074)(`./${r.pathImage}.svg`),alt:"",class:"weather-icon"},null,8,D),(0,n._)("span",k,(0,u.zw)(this.weatherShow),1)])])}var R={name:"Weather",props:{time:{type:String},weather:{type:Object}},data(){return{weatherShow:"",arrCondition:{clear:"Ясно","partly-cloudy":"Облачно",cloudy:"Облачно",overcast:"Пасмурно",drizzle:"Дождь","light-rain":"Дождь",rain:"Дождь","moderate-rain":"Дождь","heavy-rain":"Дождь","continuous-heavy-rain":"Дождь",showers:"Дождь","wet-snow":"Дождь со снегом","light-snow":"Снег",snow:"Снег","snow-showers":"Снег",hail:"Град",thunderstorm:"Гроза","thunderstorm-with-rain":"Дождь","thunderstorm-with-hail":"Град"},arrPathImage:{"Ясно":"sun-icon","Пасмурно":"clouds-icon","Дождь":"rain-icon","Снег":"snow-icon","Облачно":"cloudy-icon","Град":"hail-icon","Гроза":"thunder-icon","Дождь со снегом":"snow-rain-icon"},pathImage:"empty-icon"}},watch:{weather:function(){this.weatherShow=this.arrCondition[this.weather.condition]+", "+this.weather.temp+"°С",this.pathImage=this.arrPathImage[this.arrCondition[this.weather.condition]],console.log(this.weather)}}};const C=(0,l.Z)(R,[["render",x],["__scopeId","data-v-5c025d9c"]]);var j=C;const z={class:"station-info"},A={class:"status-title"},L={class:"status-info"};function O(t,i,a,e,s,r){return(0,n.wg)(),(0,n.iD)("div",z,[(0,n._)("h1",A,(0,u.zw)(a.status[0]),1),(0,n._)("span",L,(0,u.zw)(a.status[1]),1)])}var U={name:"Status",props:{status:{type:Array}}};const T=(0,l.Z)(U,[["render",O],["__scopeId","data-v-fc0f2636"]]);var Z=T,I={components:{Stations:Z,Weather:j},props:{uid:{type:String},date:{type:String}},data(){return{baseURL:"https://mypew.ru:3001/stops",arrStop:[],interval:null,time:"",status:["",""],baseURLWeather:"https://mypew.ru:3001/weather",stationNow:"",weather:{}}},methods:{async loadTrip(){try{const t=await y.ZP.get(this.baseURL+"?uid="+this.uid+"&date="+this.date.slice(0,10));this.arrStop=t.data.stops,console.log(this.arrStop),this.arrStop.forEach(((t,i)=>{t.arrival&&(t.arrivalShow=t.arrival.slice(11,16)),t.departure&&(t.departureShow=t.departure.slice(11,16))})),this.createStop(),this.interval=setInterval((()=>{this.createStop()}),1e3)}catch(e){alert("Error: "+e)}},createStop(){let t=new Date,i=new Date(t.getTime()+3600*parseInt(this.date.slice(20,22))*1e3).toJSON();i=i.slice(0,10)+" "+i.slice(11);let a=i;this.arrStop[0].departure>a&&(this.status[0]="Поезд ещё не выехал"),this.arrStop[this.arrStop.length-1].arrival<a&&(this.status[0]="Поезд уже закончил свой маршрут"),this.time=i.slice(11,19),this.arrStop.forEach(((t,i)=>{t.departure>a&&t.arrival<=a?(this.status[0]="Стоянка на станции "+t.title,this.stationNow!=t.title&&(this.loadWeather(t.title,t.yandex_code),this.stationNow=t.title),i<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[i+1].title)):i<this.arrStop.length-1&&t.departure<=a&&this.arrStop[i+1].arrival>a?(this.status[0]=t.title+" - "+this.arrStop[i+1].title,this.stationNow!=this.arrStop[i+1].title&&(this.loadWeather(this.arrStop[i+1].title,this.arrStop[i+1].yandex_code),this.stationNow=this.arrStop[i+1].title),i<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[i+1].title)):i>this.arrStop.length-1&&(this.status[1]="")}))},async loadWeather(t,i){try{const a=await y.ZP.get(this.baseURLWeather+"?type_info=fact&station="+i);this.weather=a.data,console.log(t,i)}catch{alert("Error: "+e)}}},created(){this.loadTrip()}};const P=(0,l.Z)(I,[["render",g],["__scopeId","data-v-6533fa45"]]);var W=P,N=(a(7658),a(8832)),K=a(8646);const Y=t=>((0,n.dD)("data-v-0b2333ea"),t=t(),(0,n.Cn)(),t),F={class:"from"},M=Y((()=>(0,n._)("label",{for:"from",class:"from__label"},"Откуда",-1))),V={class:"from__hint"},J=["onClick"],$={class:"to"},q=Y((()=>(0,n._)("label",{for:"to",class:"to__label"},"Куда",-1))),B={class:"to__hint"},G=["onClick"],Q={class:"window info"},X={class:"info__wrapper"},tt={class:"info__header"},it={class:"info__date"},at={class:"search-segments"},et={class:"search-segments__tbody"},st=["value"],nt={class:"parameters__info"},rt={class:"parameters__info__segment"},ot=["onClick"],lt={class:"parameters__departure"},ct={class:"parameters__departure__segment"},ht={class:"parameters__total"},dt={class:"parameters__total__segment"},ut={class:"parameters__arrival"},pt={class:"parameters__arrival__segment"},_t=Y((()=>(0,n._)("div",{class:"parameters__has-left__segment"},[(0,n._)("span",{class:"parameters__has-left__segment__text"},"Ушёл")],-1))),St=[_t],mt=Y((()=>(0,n._)("div",{class:"error__wrapper"},[(0,n._)("img",{src:K,alt:"",class:"error__image",draggable:"false"}),(0,n._)("p",{class:"error__text"},"По вашему запросу не найдено результатов")],-1))),vt=[mt];function wt(t,i,a,e,r,o){return(0,n.wg)(),(0,n.iD)("main",{style:(0,u.j5)(1===r.isResultHidden?"justify-content: center":"")},[(0,n._)("div",{class:(0,u.C_)(["window search",1!==r.isResultHidden?"fixed":""])},[(0,n._)("h1",{class:(0,u.C_)(["header",1!==r.isResultHidden?"hidden":""])},"Расписание электричек",2),(0,n._)("div",{class:(0,u.C_)(["form",1!==r.isResultHidden?"fixed-margin":""])},[(0,n._)("div",F,[(0,n.wy)((0,n._)("input",{type:"text",id:"from",class:"from__input",placeholder:" ",autocomplete:"off",onClick:i[0]||(i[0]=t=>o.clickStartStation()),"onUpdate:modelValue":i[1]||(i[1]=t=>r.startStation=t),onKeyup:i[2]||(i[2]=(0,s.D2)((t=>o.enterClicked()),["enter"]))},null,544),[[s.nr,r.startStation]]),M,(0,n._)("div",V,(0,u.zw)(r.fromHint),1),(0,n._)("div",{class:"search-results",style:(0,u.j5)(r.isAvailStart?"display: block":"display: none")},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.arrStartStation,(t=>((0,n.wg)(),(0,n.iD)("button",{onClick:i=>o.addStartStation(t.station_name),class:"element-button",key:t.station_yandex_code},(0,u.zw)(t.station_name),9,J)))),128))],4)]),(0,n._)("img",{src:N,alt:"",draggable:"false",onClick:i[3]||(i[3]=t=>o.changeStation()),style:{cursor:"pointer"}}),(0,n._)("div",$,[(0,n.wy)((0,n._)("input",{type:"text",id:"to",class:"to__input",placeholder:" ",autocomplete:"off",onClick:i[4]||(i[4]=t=>o.clickEndStation()),"onUpdate:modelValue":i[5]||(i[5]=t=>r.endStation=t),onKeyup:i[6]||(i[6]=(0,s.D2)((t=>o.enterClicked()),["enter"]))},null,544),[[s.nr,r.endStation]]),q,(0,n._)("div",B,(0,u.zw)(r.toHint),1),(0,n._)("div",{class:"search-results",style:(0,u.j5)(r.isAvailEnd?"display: block":"display: none")},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.arrEndStation,(t=>((0,n.wg)(),(0,n.iD)("button",{onClick:i=>o.addEndStation(t.station_name),class:"element-button",key:t.station_yandex_code},(0,u.zw)(t.station_name),9,G)))),128))],4)]),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":i[7]||(i[7]=t=>r.selectDate=t),type:"date",id:"date",class:"date"},null,512),[[s.nr,r.selectDate]]),(0,n._)("button",{class:"search-button",onClick:i[8]||(i[8]=t=>o.getStation())},"Найти маршруты")],2)],2),(0,n._)("div",{class:"results",style:(0,u.j5)(3===r.isResultHidden?"":"display: none")},[(0,n._)("div",Q,[(0,n._)("div",X,[(0,n._)("h1",tt,"Расписания по маршруту "+(0,u.zw)(r.startStation)+" – "+(0,u.zw)(r.endStation),1),(0,n._)("p",it,(0,u.zw)(r.selectDate),1)])]),(0,n._)("table",at,[(0,n._)("tbody",et,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.arrRoute,(i=>((0,n.wg)(),(0,n.iD)("tr",{class:"parameters",key:i.uid,value:i.uid},[(0,n._)("td",nt,[(0,n._)("div",rt,[(0,n._)("div",{class:"parameters__info__segment__route",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},[(0,n._)("span",{class:"parameters__info__segment__route__text",onClick:a=>{t.$router.push({name:"TripPage",params:{uid:i.uid,date:i.dep}})}},(0,u.zw)(i.title),9,ot)],4),(0,n._)("span",{class:"parameters__info__segment__company",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},(0,u.zw)(i.carrier),5)])]),(0,n._)("td",lt,[(0,n._)("div",ct,[(0,n._)("span",{class:"parameters__departure__segment__time",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},(0,u.zw)(i.depShow),5),(0,n._)("span",{class:"parameters__departure__segment__explain",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},"Отбытие",4)])]),(0,n._)("td",ht,[(0,n._)("div",dt,[(0,n._)("span",{class:"parameters__total__segment__time",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},(0,u.zw)(i.travelTimeShow),5)])]),(0,n._)("td",ut,[(0,n._)("div",pt,[(0,n._)("span",{class:"parameters__arrival__segment__time",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},(0,u.zw)(i.arrShow),5),(0,n._)("span",{class:"parameters__arrival__segment__explain",style:(0,u.j5)(i.isLeave?"opacity: 50%":"")},"Прибытие",4)])]),(0,n._)("td",{class:"parameters__has-left",style:(0,u.j5)(i.isLeave?"":"display: none")},St,4)],8,st)))),128))])])],4),(0,n._)("div",{class:"error",style:(0,u.j5)(2===r.isResultHidden?"":"display: none")},vt,4)],4)}var ft={data(){return{startStation:"",endStation:"",baseURL:"https://mypew.ru:3001/routes",findURL:"https://mypew.ru:3001/possible",arrRoute:[],arrStartStation:[],isAvailStart:!1,arrEndStation:[],isAvailEnd:!1,isResultHidden:1,selectStartStation:!1,selectEndStation:!1,selectDate:"",fromHint:"",toHint:""}},methods:{async changeStartStation(){this.startStation=this.startStation.trimStart();let t=this.startStation;if(""==this.startStation||this.selectStartStation)this.fromHint="",this.selectStartStation=!1,this.isAvailStart=!1,this.arrStartStation=[];else try{0!==this.arrStartStation.length?this.fromHint=this.startStation.trim()+this.arrStartStation[0].station_name.slice(this.startStation.trim().length):this.fromHint="";const i=await y.ZP.get(this.findURL+"?station_name="+this.startStation.trim());t===this.startStation&&(this.arrStartStation=i.data,0!==this.arrStartStation.length?(this.isAvailStart=!0,this.fromHint=this.startStation.trim()+this.arrStartStation[0].station_name.slice(this.startStation.trim().length),this.fromHint==this.startStation&&(this.fromHint="")):(this.fromHint="",this.arrStartStation=[],this.isAvailStart=!1))}catch(e){alert("Error: "+e)}},async changeEndStation(){this.endStation=this.endStation.trimStart();let t=this.endStation;if(""==this.endStation||this.selectEndStation)this.toHint="",this.selectEndStation=!1,this.isAvailEnd=!1,this.arrEndStation=[];else try{0!==this.arrEndStation.length?this.toHint=this.endStation.trim()+this.arrEndStation[0].station_name.slice(this.endStation.trim().length):this.toHint="";const i=await y.ZP.get(this.findURL+"?station_name="+this.endStation);t===this.endStation&&(this.arrEndStation=i.data,0!==this.arrEndStation.length?(this.isAvailEnd=!0,this.toHint=this.endStation.trim()+this.arrEndStation[0].station_name.slice(this.endStation.trim().length),this.toHint==this.endStation&&(this.toHint="")):(this.toHint="",this.arrEndStation=[],this.isAvailEnd=!1))}catch(e){alert("Error: "+e)}},clickStartStation(){this.selectStartStation=!1,this.arrEndStation=[],this.isAvailEnd=!1,this.changeStartStation()},clickEndStation(){this.selectEndStation=!1,this.arrStartStation=[],this.isAvailStart=!1,this.changeEndStation()},addStartStation(t){this.selectStartStation=!0,this.startStation=t,this.arrStartStation=[],this.isAvailStart=!1,this.fromHint=""},addEndStation(t){this.selectEndStation=!0,this.endStation=t,this.arrEndStation=[],this.isAvailEnd=!1,this.toHint=""},async getStation(){if(this.arrStartStation=[],this.isAvailEnd=!1,this.arrEndStation=[],this.isAvailStart=!1,""!=this.startStation&&""!=this.endStation&&""!=this.selectDate)try{const t=await y.ZP.get(this.baseURL+"?from="+this.startStation+"&to="+this.endStation+"&transport_types=suburban&date="+this.selectDate);this.arrRoute=t.data,console.log(this.arrRoute),0===this.arrRoute.length?this.isResultHidden=2:this.isResultHidden=3,this.arrRoute.map((t=>{t.hour=t.dep[21],t.depShow=t.dep.slice(11,16),t.arrShow=t.arr.slice(11,16),"Байкальская пригородная пассажирская компания"===t.carrier&&(t.carrier="Байкальская ППК"),t.dep>new Date((new Date).getTime()+3600*t.dep.slice(20,22)*1e3).toJSON()?t.isLeave=!1:t.isLeave=!0;let i=(new Date(t.arr)-new Date(t.dep))/6e4,a=0;i>=60?(a=Math.trunc(i/60),t.travelTimeShow=a+" ч "):t.travelTimeShow="",t.travelTimeShow+=i-60*a+" мин"}))}catch(e){alert("Error: "+e)}},changeStation(){this.selectStartStation=!0,this.arrEndStation=[],this.isAvailEnd=!1,this.selectEndStation=!0,this.arrStartStation=[],this.isAvailStart=!1;let t=this.startStation;this.startStation=this.endStation,this.endStation=t},enterClicked(){""!=this.fromHint&&(this.startStation=this.fromHint,this.fromHint="",this.selectStartStation=!0,this.isAvailStart=!1),""!=this.toHint&&(this.endStation=this.toHint,this.toHint="",this.selectEndStation=!0,this.isAvailEnd=!1)}},watch:{startStation:function(){this.changeStartStation()},endStation:function(){this.changeEndStation()}},created(){let t=(new Date).toLocaleDateString();this.selectDate=t.slice(6,10)+"-"+t.slice(3,5)+"-"+t.slice(0,2),document.addEventListener("click",(()=>{this.selectStartStation=!1,this.arrEndStation=[],this.isAvailEnd=!1,this.selectEndStation=!1,this.arrStartStation=[],this.isAvailStart=!1,this.fromHint="",this.toHint=""}))}};const gt=(0,l.Z)(ft,[["render",wt],["__scopeId","data-v-0b2333ea"]]);var yt=gt;const bt=[{path:"/trip/:uid/:date",name:"TripPage",component:W,props:!0},{path:"/",component:yt}],Et=(0,d.p7)({routes:bt,history:(0,d.r5)("/RZD-Ride-Frontend/")});var Ht=Et;(0,s.ri)(h).use(Ht).mount("#app")},8074:function(t,i,a){var e={"./arrows.svg":8832,"./clouds-icon.svg":4880,"./cloudy-icon.svg":2588,"./empty-icon.svg":5436,"./hail-icon.svg":1678,"./rain-icon.svg":6461,"./smile.svg":8646,"./snow-icon.svg":2830,"./snow-rain-icon.svg":8150,"./sun-icon.svg":1304,"./thunder-icon.svg":3079};function s(t){var i=n(t);return a(i)}function n(t){if(!a.o(e,t)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return e[t]}s.keys=function(){return Object.keys(e)},s.resolve=n,t.exports=s,s.id=8074},8832:function(t,i,a){"use strict";t.exports=a.p+"img/arrows.31404f47.svg"},4880:function(t,i,a){"use strict";t.exports=a.p+"img/clouds-icon.090d590d.svg"},2588:function(t,i,a){"use strict";t.exports=a.p+"img/cloudy-icon.44727660.svg"},5436:function(t,i,a){"use strict";t.exports=a.p+"img/empty-icon.e50c9624.svg"},1678:function(t,i,a){"use strict";t.exports=a.p+"img/hail-icon.6b5dc544.svg"},6461:function(t,i,a){"use strict";t.exports=a.p+"img/rain-icon.a6abbf29.svg"},8646:function(t,i,a){"use strict";t.exports=a.p+"img/smile.1ac3bfa7.svg"},2830:function(t,i,a){"use strict";t.exports=a.p+"img/snow-icon.4a3776de.svg"},8150:function(t,i,a){"use strict";t.exports=a.p+"img/snow-rain-icon.e82449b4.svg"},1304:function(t,i,a){"use strict";t.exports=a.p+"img/sun-icon.bb07a1b0.svg"},3079:function(t,i,a){"use strict";t.exports=a.p+"img/thunder-icon.1bc0f9cd.svg"}},i={};function a(e){var s=i[e];if(void 0!==s)return s.exports;var n=i[e]={exports:{}};return t[e](n,n.exports,a),n.exports}a.m=t,function(){var t=[];a.O=function(i,e,s,n){if(!e){var r=1/0;for(h=0;h<t.length;h++){e=t[h][0],s=t[h][1],n=t[h][2];for(var o=!0,l=0;l<e.length;l++)(!1&n||r>=n)&&Object.keys(a.O).every((function(t){return a.O[t](e[l])}))?e.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(h--,1);var c=s();void 0!==c&&(i=c)}}return i}n=n||0;for(var h=t.length;h>0&&t[h-1][2]>n;h--)t[h]=t[h-1];t[h]=[e,s,n]}}(),function(){a.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(i,{a:i}),i}}(),function(){a.d=function(t,i){for(var e in i)a.o(i,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)}}(),function(){a.p="/RZD-Ride-Frontend/"}(),function(){var t={143:0};a.O.j=function(i){return 0===t[i]};var i=function(i,e){var s,n,r=e[0],o=e[1],l=e[2],c=0;if(r.some((function(i){return 0!==t[i]}))){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(l)var h=l(a)}for(i&&i(e);c<r.length;c++)n=r[c],a.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return a.O(h)},e=self["webpackChunkrzd_ride_frontend"]=self["webpackChunkrzd_ride_frontend"]||[];e.forEach(i.bind(null,0)),e.push=i.bind(null,e.push.bind(e))}();var s=a.O(void 0,[998],(function(){return a(6241)}));s=a.O(s)})();
//# sourceMappingURL=app.12d601b7.js.map