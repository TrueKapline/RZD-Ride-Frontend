(function(){var t={1842:function(t,a,i){"use strict";var e=i(9242),s=i(3396);function n(t,a,i,e,n,r){const o=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(o)}var r={},o=i(89);const l=(0,o.Z)(r,[["render",n]]);var h=l,c=i(2483),d=i(7139);const u=t=>((0,s.dD)("data-v-49567d38"),t=t(),(0,s.Cn)(),t),S={class:"status window"},p={class:"lower-part"},_={class:"time-table window"},m={key:0},v=u((()=>(0,s._)("div",{class:"map window"},null,-1))),w=u((()=>(0,s._)("div",{class:"interesting window"},null,-1)));function f(t,a,i,e,n,r){const o=(0,s.up)("Stations"),l=(0,s.up)("Weather");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",S,[(0,s.Wm)(o,{status:this.status},null,8,["status"]),(0,s.Wm)(l,{time:this.time,weather:n.weather},null,8,["time","weather"])]),(0,s._)("div",p,[(0,s._)("div",_,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.arrStop,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.duration},[(0,s.Uk)((0,d.zw)(t.arrivalShow)+" ",1),t.arrivalShow&&t.departureShow?((0,s.wg)(),(0,s.iD)("span",m,"-")):(0,s.kq)("",!0),(0,s.Uk)(" "+(0,d.zw)(t.departureShow)+" "+(0,d.zw)(t.title),1)])))),128))]),v,w])],64)}var g=i(70);const y={class:"time-and-weather"},E={class:"time"},b={class:"weather"},D=["src"],H={class:"weather-text"};function k(t,a,e,n,r,o){return(0,s.wg)(),(0,s.iD)("div",y,[(0,s._)("h1",E,(0,d.zw)(e.time),1),(0,s._)("div",b,[(0,s._)("img",{src:i(8074)(`./${r.pathImage}.svg`),alt:"",class:"weather-icon"},null,8,D),(0,s._)("span",H,(0,d.zw)(this.weatherShow),1)])])}var z={name:"Weather",props:{time:{type:String},weather:{type:Object}},data(){return{weatherShow:"",arrCondition:{clear:"Ясно","partly-cloudy":"Облачно",cloudy:"Облачно",overcast:"Пасмурно",drizzle:"Дождь","light-rain":"Дождь",rain:"Дождь","moderate-rain":"Дождь","heavy-rain":"Дождь","continuous-heavy-rain":"Дождь",showers:"Ливень","wet-snow":"Дождь со снегом","light-snow":"Снег",snow:"Снег","snow-showers":"Снег",hail:"Град",thunderstorm:"Гроза","thunderstorm-with-rain":"Дождь","thunderstorm-with-hail":"Град"},arrPathImage:{"Ясно":"sun-icon","Пасмурно":"clouds-icon","Дождь":"rain-icon","Снег":"snow-icon"},pathImage:"empty-icon"}},watch:{weather:function(){this.weatherShow=this.arrCondition[this.weather.condition]+", "+this.weather.temp+"°С",this.pathImage=this.arrPathImage[this.arrCondition[this.weather.condition]],console.log(this.weather)}}};const A=(0,o.Z)(z,[["render",k],["__scopeId","data-v-16e61735"]]);var R=A;const j={class:"station-info"},C={class:"status-title"},L={class:"status-info"};function x(t,a,i,e,n,r){return(0,s.wg)(),(0,s.iD)("div",j,[(0,s._)("h1",C,(0,d.zw)(i.status[0]),1),(0,s._)("span",L,(0,d.zw)(i.status[1]),1)])}var O={name:"Status",props:{status:{type:Array}}};const U=(0,o.Z)(O,[["render",x],["__scopeId","data-v-fc0f2636"]]);var T=U,I={components:{Stations:T,Weather:R},props:{uid:{type:String},date:{type:String}},data(){return{baseURL:"https://mypew.ru:3001/stops",arrStop:[],interval:null,time:"",status:["",""],baseURLWeather:"https://mypew.ru:3001/weather",stationNow:"",weather:{}}},methods:{async loadTrip(){try{const t=await g.ZP.get(this.baseURL+"?uid="+this.uid+"&date="+this.date.slice(0,10));this.arrStop=t.data.stops,console.log(this.arrStop),this.arrStop.forEach(((t,a)=>{t.arrival&&(t.arrivalShow=t.arrival.slice(11,16)),t.departure&&(t.departureShow=t.departure.slice(11,16))})),this.createStop(),this.interval=setInterval((()=>{this.createStop()}),1e3)}catch(t){alert("Error: "+t)}},createStop(){let t=new Date,a=new Date(t.getTime()+3600*parseInt(this.date.slice(20,22))*1e3).toJSON(),i=a;this.arrStop[0].departure>i&&(this.status[0]="Поезд ещё не выехал"),this.arrStop[this.arrStop.length-1].arrival<i&&(this.status[0]="Поезд уже закончил свой маршрут"),this.time=a.slice(11,19),this.arrStop.forEach(((t,a)=>{if(t.departure>i&&t.arrival<=i){if(this.status[0]="Стоянка на станции "+t.title,this.stationNow!=t.title)try{this.loadWeather(t.title,t.yandex_code),this.stationNow=t.title}catch(e){alert("Error: "+e)}a<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[a+1].title)}else a<this.arrStop.length-1&&t.departure<=i&&this.arrStop[this.arrStop.length-1].arrival>i&&(this.status[0]=t.title+" - "+this.arrStop[a+1].title,a<this.arrStop.length-1&&(this.status[1]="Следующая остановка – "+this.arrStop[a+1].title))}))},async loadWeather(t,a){const i=await g.ZP.get(this.baseURLWeather+"?type_info=fact&station="+a);this.weather=i.data,console.log(t,a)}},created(){this.loadTrip()}};const Z=(0,o.Z)(I,[["render",f],["__scopeId","data-v-49567d38"]]);var P=Z,W=(i(7658),i(8832));const N=t=>((0,s.dD)("data-v-06b4daab"),t=t(),(0,s.Cn)(),t),K={class:"window search"},Y=N((()=>(0,s._)("h1",{class:"header"},"Расписание электричек",-1))),F={class:"form"},M={class:"from"},V=N((()=>(0,s._)("label",{for:"from",class:"from__label"},"Откуда",-1))),J={class:"from__hint"},$=["onClick"],q={class:"to"},B=N((()=>(0,s._)("label",{for:"to",class:"to__label"},"Куда",-1))),G={class:"to__hint"},Q=["onClick"],X={class:"window info"},tt={class:"info__wrapper"},at={class:"info__header"},it={class:"info__date"},et={class:"search-segments"},st={class:"search-segments__tbody"},nt=["value"],rt={class:"parameters__info"},ot={class:"parameters__info__segment"},lt=["onClick"],ht={class:"parameters__departure"},ct={class:"parameters__departure__segment"},dt={class:"parameters__total"},ut={class:"parameters__total__segment"},St={class:"parameters__arrival"},pt={class:"parameters__arrival__segment"};function _t(t,a,i,n,r,o){return(0,s.wg)(),(0,s.iD)("main",{style:(0,d.j5)(r.isResultHidden?"justify-content: center":"")},[(0,s._)("div",K,[Y,(0,s._)("div",F,[(0,s._)("div",M,[(0,s.wy)((0,s._)("input",{type:"text",id:"from",class:"from__input",placeholder:" ",autocomplete:"off",onClick:a[0]||(a[0]=t=>o.clickStartStation()),"onUpdate:modelValue":a[1]||(a[1]=t=>r.startStation=t),onKeyup:a[2]||(a[2]=(0,e.D2)((t=>o.enterClicked()),["enter"]))},null,544),[[e.nr,r.startStation]]),V,(0,s._)("div",J,(0,d.zw)(r.fromHint),1),(0,s._)("div",{class:"search-results",style:(0,d.j5)(r.isAvailStart?"display: block":"display: none")},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.arrStartStation,(t=>((0,s.wg)(),(0,s.iD)("button",{onClick:a=>o.addStartStation(t.station_name),class:"element-button",key:t.station_yandex_code},(0,d.zw)(t.station_name),9,$)))),128))],4)]),(0,s._)("img",{src:W,alt:"",draggable:"false",onClick:a[3]||(a[3]=t=>o.changeStation()),style:{cursor:"pointer"}}),(0,s._)("div",q,[(0,s.wy)((0,s._)("input",{type:"text",id:"to",class:"to__input",placeholder:" ",autocomplete:"off",onClick:a[4]||(a[4]=t=>o.clickEndStation()),"onUpdate:modelValue":a[5]||(a[5]=t=>r.endStation=t),onKeyup:a[6]||(a[6]=(0,e.D2)((t=>o.enterClicked()),["enter"]))},null,544),[[e.nr,r.endStation]]),B,(0,s._)("div",G,(0,d.zw)(r.toHint),1),(0,s._)("div",{class:"search-results",style:(0,d.j5)(r.isAvailEnd?"display: block":"display: none")},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.arrEndStation,(t=>((0,s.wg)(),(0,s.iD)("button",{onClick:a=>o.addEndStation(t.station_name),class:"element-button",key:t.station_yandex_code},(0,d.zw)(t.station_name),9,Q)))),128))],4)]),(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":a[7]||(a[7]=t=>r.selectDate=t),type:"date",id:"date",class:"date"},null,512),[[e.nr,r.selectDate]]),(0,s._)("button",{class:"search-button",onClick:a[8]||(a[8]=t=>o.getStation())},"Найти маршруты")])]),(0,s._)("div",{class:"results",style:(0,d.j5)(r.isResultHidden?"display: none":"")},[(0,s._)("div",X,[(0,s._)("div",tt,[(0,s._)("h1",at,"Расписания по маршруту "+(0,d.zw)(r.startStation)+" – "+(0,d.zw)(r.endStation),1),(0,s._)("p",it,(0,d.zw)(r.selectDate),1)])]),(0,s._)("table",et,[(0,s._)("tbody",st,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.arrRoute,(a=>((0,s.wg)(),(0,s.iD)("tr",{class:"parameters",key:a.uid,value:a.uid},[(0,s._)("td",rt,[(0,s._)("div",ot,[(0,s._)("span",{class:"parameters__info__segment__route",style:(0,d.j5)(a.isLeave?"opacity: 50%":""),onClick:i=>{t.$router.push({name:"TripPage",params:{uid:a.uid,date:a.dep}})}},(0,d.zw)(a.title),13,lt),(0,s._)("span",{class:"parameters__info__segment__company",style:(0,d.j5)(a.isLeave?"opacity: 50%":"")},(0,d.zw)(a.carrier.split(" ")[0]+" ППК"),5)])]),(0,s._)("td",ht,[(0,s._)("div",ct,[(0,s._)("span",{class:"parameters__departure__segment__time",style:(0,d.j5)(a.isLeave?"opacity: 50%":"")},(0,d.zw)(a.depShow),5),(0,s._)("span",{class:"parameters__departure__segment__explain",style:(0,d.j5)(a.isLeave?"opacity: 50%":"")},"Отбытие",4)])]),(0,s._)("td",dt,[(0,s._)("div",ut,[(0,s._)("span",{class:"parameters__total__segment__time",style:(0,d.j5)(a.isLeave?"opacity: 50%":"")},(0,d.zw)(a.travelTimeShow),5)])]),(0,s._)("td",St,[(0,s._)("div",pt,[(0,s._)("span",{class:"parameters__arrival__segment__time",style:(0,d.j5)(a.isLeave?"opacity: 50%":"")},(0,d.zw)(a.arrShow),5),(0,s._)("span",{class:"parameters__arrival__segment__explain",style:(0,d.j5)(a.isLeave?"opacity: 50%":"")},"Прибытие",4)])])],8,nt)))),128))])])],4)],4)}var mt={data(){return{startStation:"",endStation:"",baseURL:"https://mypew.ru:3001/routes",findURL:"https://mypew.ru:3001/possible",arrRoute:[],arrStartStation:[],isAvailStart:!1,arrEndStation:[],isAvailEnd:!1,isResultHidden:!0,selectStartStation:!1,selectEndStation:!1,selectDate:"",fromHint:"",toHint:""}},methods:{async changeStartStation(){this.startStation=this.startStation.trimStart();let t=this.startStation;if(""==this.startStation||this.selectStartStation)this.fromHint="",this.selectStartStation=!1,this.isAvailStart=!1,this.arrStartStation=[];else try{0!==this.arrStartStation.length?this.fromHint=this.startStation.trim()+this.arrStartStation[0].station_name.slice(this.startStation.trim().length):this.fromHint="";const a=await g.ZP.get(this.findURL+"?station_name="+this.startStation.trim());t===this.startStation&&(this.arrStartStation=a.data,0!==this.arrStartStation.length?(this.isAvailStart=!0,this.fromHint=this.startStation.trim()+this.arrStartStation[0].station_name.slice(this.startStation.trim().length),this.fromHint==this.startStation&&(this.fromHint="")):(this.fromHint="",this.arrStartStation=[],this.isAvailStart=!1))}catch(a){alert("Error: "+a)}},async changeEndStation(){this.endStation=this.endStation.trimStart();let t=this.endStation;if(""==this.endStation||this.selectEndStation)this.toHint="",this.selectEndStation=!1,this.isAvailEnd=!1,this.arrEndStation=[];else try{0!==this.arrEndStation.length?this.toHint=this.endStation.trim()+this.arrEndStation[0].station_name.slice(this.endStation.trim().length):this.toHint="";const a=await g.ZP.get(this.findURL+"?station_name="+this.endStation);t===this.endStation&&(this.arrEndStation=a.data,0!==this.arrEndStation.length?(this.isAvailEnd=!0,this.toHint=this.endStation.trim()+this.arrEndStation[0].station_name.slice(this.endStation.trim().length),this.toHint==this.endStation&&(this.toHint="")):(this.toHint="",this.arrEndStation=[],this.isAvailEnd=!1))}catch(a){alert("Error: "+a)}},clickStartStation(){this.selectStartStation=!1,this.arrEndStation=[],this.isAvailEnd=!1,this.changeStartStation()},clickEndStation(){this.selectEndStation=!1,this.arrStartStation=[],this.isAvailStart=!1,this.changeEndStation()},addStartStation(t){this.selectStartStation=!0,this.startStation=t,this.arrStartStation=[],this.isAvailStart=!1,this.fromHint=""},addEndStation(t){this.selectEndStation=!0,this.endStation=t,this.arrEndStation=[],this.isAvailEnd=!1,this.toHint=""},async getStation(){if(this.arrStartStation=[],this.isAvailEnd=!1,this.arrEndStation=[],this.isAvailStart=!1,""!=this.startStation&&""!=this.endStation&&""!=this.selectDate)try{const t=await g.ZP.get(this.baseURL+"?from="+this.startStation+"&to="+this.endStation+"&transport_types=suburban&date="+this.selectDate);this.isResultHidden=!1,this.arrRoute=t.data,console.log(this.arrRoute),this.arrRoute.map((t=>{t.hour=t.dep[21],t.depShow=t.dep.slice(11,16),t.arrShow=t.arr.slice(11,16),t.dep>new Date((new Date).getTime()+3600*parseInt((new Date).toTimeString().slice(13,15))*1e3).toJSON()?t.isLeave=!1:t.isLeave=!0;let a=(new Date(t.arr)-new Date(t.dep))/6e4,i=0;a>=60?(i=Math.trunc(a/60),t.travelTimeShow=i+" ч "):t.travelTimeShow="",t.travelTimeShow+=a-60*i+" мин"}))}catch(t){alert("Error: "+t)}},changeStation(){this.selectStartStation=!0,this.arrEndStation=[],this.isAvailEnd=!1,this.selectEndStation=!0,this.arrStartStation=[],this.isAvailStart=!1;let t=this.startStation;this.startStation=this.endStation,this.endStation=t},enterClicked(){""!=this.fromHint&&(this.startStation=this.fromHint,this.fromHint="",this.selectStartStation=!0,this.isAvailStart=!1),""!=this.toHint&&(this.endStation=this.toHint,this.toHint="",this.selectEndStation=!0,this.isAvailEnd=!1)}},watch:{startStation:function(){this.changeStartStation()},endStation:function(){this.changeEndStation()}},created(){let t=(new Date).toLocaleDateString();this.selectDate=t.slice(6,10)+"-"+t.slice(3,5)+"-"+t.slice(0,2),document.addEventListener("click",(()=>{this.selectStartStation=!1,this.arrEndStation=[],this.isAvailEnd=!1,this.selectEndStation=!1,this.arrStartStation=[],this.isAvailStart=!1,this.fromHint="",this.toHint=""}))}};const vt=(0,o.Z)(mt,[["render",_t],["__scopeId","data-v-06b4daab"]]);var wt=vt;const ft=[{path:"/trip/:uid/:date",name:"TripPage",component:P,props:!0},{path:"/",component:wt}],gt=(0,c.p7)({routes:ft,history:(0,c.r5)("/RZD-Ride-Frontend/")});var yt=gt;(0,e.ri)(h).use(yt).mount("#app")},8074:function(t,a,i){var e={"./arrows.svg":8832,"./clouds-icon.svg":4880,"./empty-icon.svg":5436,"./rain-icon.svg":6461,"./snow-icon.svg":2830,"./sun-icon.svg":1304};function s(t){var a=n(t);return i(a)}function n(t){if(!i.o(e,t)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return e[t]}s.keys=function(){return Object.keys(e)},s.resolve=n,t.exports=s,s.id=8074},8832:function(t,a,i){"use strict";t.exports=i.p+"img/arrows.985ee4d1.svg"},4880:function(t,a,i){"use strict";t.exports=i.p+"img/clouds-icon.8427c0c9.svg"},5436:function(t,a,i){"use strict";t.exports=i.p+"img/empty-icon.e50c9624.svg"},6461:function(t,a,i){"use strict";t.exports=i.p+"img/rain-icon.6aa88b53.svg"},2830:function(t,a,i){"use strict";t.exports=i.p+"img/snow-icon.44ae6633.svg"},1304:function(t,a,i){"use strict";t.exports=i.p+"img/sun-icon.46b9915d.svg"}},a={};function i(e){var s=a[e];if(void 0!==s)return s.exports;var n=a[e]={exports:{}};return t[e](n,n.exports,i),n.exports}i.m=t,function(){var t=[];i.O=function(a,e,s,n){if(!e){var r=1/0;for(c=0;c<t.length;c++){e=t[c][0],s=t[c][1],n=t[c][2];for(var o=!0,l=0;l<e.length;l++)(!1&n||r>=n)&&Object.keys(i.O).every((function(t){return i.O[t](e[l])}))?e.splice(l--,1):(o=!1,n<r&&(r=n));if(o){t.splice(c--,1);var h=s();void 0!==h&&(a=h)}}return a}n=n||0;for(var c=t.length;c>0&&t[c-1][2]>n;c--)t[c]=t[c-1];t[c]=[e,s,n]}}(),function(){i.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(a,{a:a}),a}}(),function(){i.d=function(t,a){for(var e in a)i.o(a,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:a[e]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){i.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){i.p="/RZD-Ride-Frontend/"}(),function(){var t={143:0};i.O.j=function(a){return 0===t[a]};var a=function(a,e){var s,n,r=e[0],o=e[1],l=e[2],h=0;if(r.some((function(a){return 0!==t[a]}))){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)var c=l(i)}for(a&&a(e);h<r.length;h++)n=r[h],i.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return i.O(c)},e=self["webpackChunkrzd_ride_frontend"]=self["webpackChunkrzd_ride_frontend"]||[];e.forEach(a.bind(null,0)),e.push=a.bind(null,e.push.bind(e))}();var e=i.O(void 0,[998],(function(){return i(1842)}));e=i.O(e)})();
//# sourceMappingURL=app.49df0abd.js.map